{"root":{"data":{"id":"bvcmpl7ftpc0","created":1562462443071,"text":"互联网 网站架构 设计"},"children":[{"data":{"id":"bvcmpwxbbiw0","created":1562462468580,"text":"web应用三层模型","expandState":"collapse"},"children":[{"data":{"id":"bvcmscqmmps0","created":1562462659732,"text":"1 MTV\ndjango"},"children":[{"data":{"id":"bvcmsqubg4w0","created":1562462690431,"text":"1 model\n负责业务对象与数据库的对象ORM(对象关系映射)"},"children":[]},{"data":{"id":"bvcmtxtjqrc0","created":1562462783986,"text":"2 Template\n负责页面展示"},"children":[]},{"data":{"id":"bvcmu6hwb5k0","created":1562462802872,"text":"3 View\n负责业务逻辑"},"children":[]}]},{"data":{"id":"bvcmseug4zs0","created":1562462664317,"text":"2 MVC"},"children":[]}]},{"data":{"id":"bvcmv7l4hlc0","created":1562462883608,"text":"四层模型"},"children":[{"data":{"id":"bvcmvh1g4c80","created":1562462904186,"text":"接入层"},"children":[{"data":{"id":"bvcmwde40q00","created":1562462974609,"text":"nginx\n7层反向代理"},"children":[]}]},{"data":{"id":"bvcmvopxs2w0","created":1562462920905,"text":"业务逻辑层"},"children":[{"data":{"id":"bvcmwnf3c280","created":1562462996436,"text":"php/java/go/python"},"children":[]}]},{"data":{"id":"bvcmvslwh000","created":1562462929368,"text":"数据访问层/基础服务层","expandState":"collapse"},"children":[{"data":{"id":"bvcmxfkgwps0","created":1562463057711,"text":"zookeeper/etcd/kafka"},"children":[]}]},{"data":{"id":"bvcn786zgc00","created":1562463825300,"text":"数据层","expandState":"expand"},"children":[{"data":{"id":"bvcn82nfixk0","created":1562463891598,"text":"按照数据存储方式划分","expandState":"expand"},"children":[{"data":{"id":"bvcn82nfca80","created":1562463891598,"text":"非关系数据库\nkv存储"},"children":[{"data":{"id":"bvcn82ngcvs0","created":1562463891599,"text":"redis\\n\nmemcached\\n\nmongodb\\n\nHbase(大数据生态圈里重要组件)"},"children":[]}]},{"data":{"id":"bvcn82nfw9s0","created":1562463891599,"text":"关系型数据库"},"children":[{"data":{"id":"bvcn82ngsuw0","created":1562463891600,"text":"sql server\nmysql\nmariadb\npostgresql\noracle"},"children":[]}]}]},{"data":{"id":"bvcniroy8m80","created":1562464729751,"text":"数据库集群架构","expandState":"expand"},"children":[{"data":{"id":"bvcnixo2dps0","created":1562464742758,"text":"1 主从架构\n主:负责写数据\n从:负责读数据\n实现了读写分离,数据备份","layout_right_offset":{"x":16,"y":0},"expandState":"expand"},"children":[{"data":{"id":"bvcnm7ijq1k0","created":1562464999285,"text":"1 一主两从","expandState":"expand"},"children":[{"data":{"id":"bvcnohvp3yo0","created":1562465178576,"text":"缺点:主节点是单点,无法实现高可用"},"children":[]}]},{"data":{"id":"bvcnnh68za80","created":1562465098673,"text":"2 互为主从+keepalived\n监听一个Vip\n负载均衡转发规则:DR","expandState":"expand"},"children":[{"data":{"id":"bvcnpr3btpk0","created":1562465276993,"text":"缺点:会发生脑裂现象"},"children":[]},{"data":{"id":"bvcobvmxjh40","created":1562467010897,"text":"导致脑裂的原因:","expandState":"expand"},"children":[{"data":{"id":"bvcof71rzmg0","created":1562467270832,"text":"硬件原因","expandState":"collapse"},"children":[{"data":{"id":"bvcofgz3m5c0","created":1562467292438,"text":"1 心跳线老化,短了"},"children":[]},{"data":{"id":"bvcofx6j6u00","created":1562467327715,"text":"2 网卡驱动坏了"},"children":[]},{"data":{"id":"bvcog5w9u1s0","created":1562467346686,"text":"3 仲裁机器故障"},"children":[]}]},{"data":{"id":"bvcofbpp17k0","created":1562467280985,"text":"软件原因","expandState":"expand"},"children":[{"data":{"id":"bvcoggvfgs80","created":1562467370580,"text":"1 防火墙配置导致"},"children":[]},{"data":{"id":"bvcogly9n140","created":1562467381635,"text":"2 配置不当导致","expandState":"collapse"},"children":[{"data":{"id":"bvcoh0wjfmo0","created":1562467414183,"text":"1 心跳方式不同"},"children":[]},{"data":{"id":"bvcoh6kxybk0","created":1562467426542,"text":"2 心跳广播冲突"},"children":[]}]}]}]},{"data":{"id":"bvcohmhszmw0","created":1562467461181,"text":"防止脑裂发生措施","expandState":"collapse"},"children":[{"data":{"id":"bvcohu3x70o0","created":1562467477756,"text":"1 硬件冗余"},"children":[]},{"data":{"id":"bvcoi2d6wmg0","created":1562467495730,"text":"2 做好脑裂监控","expandState":"expand"},"children":[{"data":{"id":"bvcoi8eq6ag0","created":1562467508884,"text":"发报警,op通过回复对应的字符串等操作给服务器发送指令,自动执行处理相关故障"},"children":[]}]}]}]},{"data":{"id":"bvcp9s63xt40","created":1562469667731,"text":"3 MHA 工作原理\nmaster 高可用","expandState":"expand"},"children":[{"data":{"id":"bvcpnixhi000","created":1562470744717,"text":"MHA服务的两种角色","expandState":"collapse"},"children":[{"data":{"id":"bvcpnv6c2cw0","created":1562470771373,"text":"1 MMA Manger\n管理节点\n部署在独立的服务器上\n负责监测集群中的主节点\n并且在主从切换时负责调度切换流程"},"children":[]},{"data":{"id":"bvcpo4lnknk0","created":1562470791891,"text":"2 MHA Node\n数据节点\n部署在mysql服务器上"},"children":[]}]},{"data":{"id":"bvcpqrx0t3c0","created":1562470999372,"text":"适用场景","expandState":"collapse"},"children":[{"data":{"id":"bvcpqxmm0xc0","created":1562471011803,"text":"一主两从\n一个master,一个备用master,一个slave"},"children":[]}]}]},{"data":{"id":"bvcq2zltayg0","created":1562471956479,"text":"4 主从复制原理"},"children":[{"data":{"id":"bvcq35y09480","created":1562471970277,"text":"master","expandState":"expand"},"children":[{"data":{"id":"bvcqb7xv2940","created":1562472601535,"text":"log dump线程"},"children":[{"data":{"id":"bvcqbdld9nk0","created":1562472613840,"text":"当有从库连接到主库的时候\n主库都会创建一个线程,负责将binlog内容发送给从库"},"children":[]}]}]},{"data":{"id":"bvcq3cru3uo0","created":1562471985141,"text":"slave","expandState":"collapse"},"children":[{"data":{"id":"bvcq61h22zk0","created":1562472195637,"text":"IO线程"},"children":[{"data":{"id":"bvcq683ek2w0","created":1562472210049,"text":"1 负责与主库建立连接"},"children":[]},{"data":{"id":"bvcq6l277000","created":1562472238274,"text":"2 读取主库的binlog文件,并写入到自己的relay-log里"},"children":[]}]},{"data":{"id":"bvcq64pb3140","created":1562472202666,"text":"SQL线程"},"children":[{"data":{"id":"bvcq7myijj40","created":1562472320769,"text":"负责读取relay-log里的更新事件并执行,使主从同步"},"children":[]}]},{"data":{"id":"bvcqkaymyqo0","created":1562473313390,"text":"master.info"},"children":[{"data":{"id":"bvcqkdlj6g00","created":1562473319127,"text":"1 记录是那个binlog文件给我的信息"},"children":[]},{"data":{"id":"bvcqkwoeiq00","created":1562473360660,"text":"2 bin-log positon 位置信息"},"children":[]}]}]},{"data":{"id":"bvcqltc1bcg0","created":1562473431746,"text":"详细描述","expandState":"collapse"},"children":[{"data":{"id":"bvcqlxl9ff40","created":1562473441011,"text":"1 从节点的IO线程连接主库,\n并发送请求\n请求内容包括:\n1指定日志文件名称\n2 指定日志文件的读取位置","expandState":"expand","layout_right_offset":{"x":164,"y":-5}},"children":[]},{"data":{"id":"bvcqq7ub9280","created":1562473776783,"text":"2 主库收到从节点的IO请求后,\n通过log dump线程将信息返回给从节点\n返回信息包括:\nA:自上次发送之后的变更信息\nB:binlog 文件名\nC:读取binlog文件的位置信息\n从节点的I/O进程接收到内容后，将接收到的日志内容更新到本机的relaylog中，并将读取到的binary log文件名和位置保存到master-info 文件中，\n以便在下一次读取的时候能够清楚的告诉Master“我需要从某个bin-log 的哪个位置开始往后的日志内容，请发给我”","layout_right_offset":{"x":173,"y":10}},"children":[]},{"data":{"id":"bvcqug98dgg0","created":1562474108556,"text":"3  从库的sql 线程检测到relay-log 中新增加了内容后，\n会将relay-log的内容解析成在祝节点上\n实际执行过的操作，并在本数据库中执行","layout_right_offset":{"x":154,"y":14}},"children":[]}]}]},{"data":{"id":"bvcqjdnbhmo0","created":1562473240871,"text":"5 主从复制模式"},"children":[{"data":{"id":"bvcqjhxk28w0","created":1562473250198,"text":"异步复制(default)","expandState":"expand"},"children":[]},{"data":{"id":"bvcqjn7v0hc0","created":1562473261704,"text":"全同步复制"},"children":[]},{"data":{"id":"bvcqjqy9blc0","created":1562473269831,"text":"版同步复制"},"children":[]}]},{"data":{"id":"bvcqvxzmn3c0","created":1562474225521,"text":"6 主从复制故障处理"},"children":[]}]},{"data":{"id":"bvcp5gyynyw0","created":1562469329898,"text":"2 mysql官方集群\nmysql cluster","layout_right_offset":{"x":23,"y":3}},"children":[{"data":{"id":"bvdhs9ori3s0","created":1562550107497,"text":"分片技术"},"children":[]}]}]}]}]}]},"template":"right","theme":"fresh-blue","version":"1.4.43"}